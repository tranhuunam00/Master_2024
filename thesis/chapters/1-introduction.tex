Ngưng thở tắc nghẽn khi ngủ (Obstructive Sleep Apnea – OSA) là một rối loạn hô hấp phổ biến trong giấc ngủ, được đặc trưng bởi các đợt ngưng thở hoặc giảm thông khí tắc nghẽn lặp đi lặp lại trong lúc ngủ, dẫn đến việc gián đoạn giấc ngủ do vi thức giấc và giảm oxy trong máu.  Tỷ lệ hiện mắc OSA tại Việt Nam ước tính khoảng 8,5\% \cite{nguoimacOSA_VN}. OSA hiện được công nhận là một yếu tố có nguy cơ độc lập đối với nhiều bệnh lý liên quan đến tim mạch, đặc biệt là tăng huyết áp. Ngoài ra, hội chứng này còn có mối liên hệ đáng kể với các nguy cơ như tai nạn giao thông, tai nạn lao động dẫn đến làm gia tăng gánh nặng kinh tế xã hội\cite{osa_bike}\cite{Marin2005}\cite{drive_osa}. Đáng chú ý, tình trạng ngưng thở khi ngủ kéo dài và không được phát hiện, điều trị có thể ảnh hưởng nghiêm trọng đến sức khỏe gây ra rối loạn nhịp tim và một trong những nguyên nhân gây đột tử \cite{sumarry_osa}. Theo PSG.TS Nguyễn Thy Khuê, Hội Y học Giấc ngủ Việt Nam, ngưng thở khi ngủ còn là một trong nhưng dấu hiệu rõ ràng của bệnh đái tháo đường, bệnh thận \cite{bsThyKhue}. OSA được phát hiện ở hơn 20\% người bệnh đái tháo đường và làm trầm trọng thêm các rối loạn chuyển hóa, đặc biệt là đái tháo đường type 2. Trong một nghiên cứu tiêu biểu tại Việt Nam, GS.TS. Dương Quý Sỹ và cộng sự đã khảo sát 524 trẻ em mắc rối loạn tăng động giảm chú ý (Attention Deficit Hyperactivity Disorder - ADHD) tại Bệnh viện Nhi Trung ương Việt Nam. Kết quả cho thấy tỷ lệ mắc (OSA) ở nhóm này là 23.3\%, trong đó chủ yếu ở mức độ trung bình đến nặng \cite{ThaySUCHildren}. Nghiên cứu cũng đồng thời xác định mối tương quan đáng kể giữa mức độ nghiêm trọng của OSA và các triệu chứng mất tập trung, tăng động, rối loạn hành vi, lo âu và trầm cảm. Phát hiện nhấn mạnh sự cần thiết của việc sàng lọc OSA trong quá trình điều trị toàn diện ADHD ở trẻ em. 

Một dạng đặc biệt của OSA được ghi nhận là ngưng thở khi ngủ do tư thế (Positional Obstructive Sleep Apnea - pOSA). Bệnh nhân được chẩn đoán mắc pOSA có chỉ số AHI lớn hơn 5, và giá trị AHI ở tư thế ngửa cao gấp ít nhất hai lần so với nằm ở tư thế khác \cite{heinzer2018}. Các nghiên cứu gần đây chỉ ra rằng tỷ lệ mắc pOSA lên tới 50\% bệnh nhân OSA \cite{sabil2020}. Điều này cho thấy tư thế ngủ có ảnh hưởng sinh lý rõ rệt đến sự sụp đổ đường thở trên, đặc biệt ở tư thế nằm ngữa. Lúc nằm ngửa, trọng lực làm xẹp các cơ vùng họng dẫn đến làm hẹp khoang khí.

Việc chẩn đoán hội chứng ngưng thở tắc nghẽn khi ngủ (OSA) hiện nay chủ yếu được thực hiện thông qua hai phương pháp: đa ký giấc ngủ (Polysomnography – PSG) và thiết bị kiểm tra giấc ngủ tại nhà (Home Sleep Test – HST). Trong đó, PSG được xem là tiêu chuẩn vàng trong việc đánh giá OSA. Do phương pháp này cho phép thu thập đồng thời nhiều thông số sinh lý quan trọng bao gồm: luồng khí hô hấp qua mũi và/hoặc miệng, cử động thành ngực và bụng, tiếng ngáy, điện não đồ (Electroencephalography – EEG), điện tâm đồ (Electrocardiography – ECG), điện cơ đồ (Electromyography – EMG), và độ bão hòa oxy trong máu (SpO$_2$). Quá trình đo PSG phải được thực hiện trong môi trường có kiểm soát tại các cơ sở y tế chuyên khoa, dưới sự giám sát trực tiếp của bác sỹ chuyên ngành giấc ngủ hoặc kĩ thuật viên có chuyên môn\cite{psg_paper}\cite{kushida2005psg}. 

Mặc dù PSG vẫn giữ vai trò là phương pháp tham chiếu trong chẩn đoán và theo dõi chất lượng giấc ngủ cũng như các rối loạn liên quan, nhưng việc triển khai kỹ thuật này thường đòi hỏi chi phí cao, trang thiết bị chuyên dụng và điều kiện thực hiện tại các cơ sở y tế chuyên khoa. Một thách thức khác của PSG là người bệnh thường cảm thấy bất tiện và cảm giác khó chịu do mang nhiều cảm biến gắn trên cơ thể trong suốt đêm, dẫn đến nguy cơ gián đoạn hoặc sai lệnh dữ liệu trong quá trình ghi nhận. Vì vậy, các hệ thống HST đang ngày càng thu hút sự quan tâm từ cộng đồng khoa học toàn cầu\cite{e3hst}\cite{hstSurvey}\cite{hst_paper}. Các thiết bị HST hiện đại dùng các cảm biến không xâm lấn nhằm ghi nhận và phân tích một số tín hiệu sinh lý cơ bản như luồng khí hô hấp, tư thế ngủ, áp suất mũi, độ bão hòa oxy và nhịp tim. Việc cải thiện chất lượng, kéo dài thời lượng sử dụng và tăng độ chính xác và cải thiện mức độ thoải mái vẫn là những thách thức lớn đối với giới nghiên cứu và các nhà sản xuất thiết bị y tế. Tuy nhiên, với những tiến bộ công nghệ đang diễn ra nhanh chóng, HST có tiềm năng trở thành một công cụ chẩn đoán quan trọng và được ứng dụng rộng rãi trong lâm sàng. Điều này không chỉ mang lại sự thuận tiện và chấp nhận cao hơn từ phía người bệnh, mà còn góp phần làm giảm gánh nặng chi phí và áp lực cho hệ thống chăm sóc sức khỏe.

Trong những năm gần đây, nhiều nhóm nghiên đang chú trọng nghiên cứu, phát triển hệ thống HST nhằm mục đích thay thế hoặc hỗ trợ cho đa ký giấc ngủ. Năm 2011, Collop và cộng sự đã phát triển một hệ thống phân loại SCOPER (Sleep, Cardiovacular, Oximetry, Position, Effort, and Respiration) để đánh giá các tín hiệu sinh lý thu nhận trong việc chẩn đoán OSA\cite{hst_6p_paper}. Tác giả Morillo D và cộng sự đề xuất một phương pháp sàng lọc ngưng thở tắc nghẽn khi ngủ dựa trên cảm biến gia tốc gắn tại vị trí hõm ức, cho phép trích xuất các tín hiệu hô hấp, tim mạch và tiếng ngáy bằng kỹ thuật xử lý tín hiệu số, từ đó chứng minh tính khả thi của thiết bị di động đơn giản và chi phí thấp trong hỗ trợ chẩn đoán hội chứng ngưng thở – giảm thở khi ngủ\cite{morillo2010accelerometer}. Trong nhóm các thiết bị đeo, A.H. Yüzer và cộng sự đã phát triển thiết bị đeo tay sử dụng cảm biến gia tốc ADXL345 để phát hiện và phát tín hiệu rung khi cảnh báo. \cite{hst_wear_paper}. Tương tự, nhóm Yunyoung Nam và cộng sự cũng đã tích hợp hệ thống thu thập, phân tích sử dụng một cảm biến gia tốc ba trục và một cảm biến áp suất để giám sát chất lượng giấc ngủ tư thế ngủ, trạng thái ngủ, giai đoạn ngủ (REM và chu kỳ giai đoạn ngủ không REM) \cite{hst_pressure_paper}. Tại Việt Nam, nhóm nghiên cứu của  Giáo sư Lê Tiến Thường, trường đại học Bách Khoa TP Hồ Chí Minh đã sử dụng cảm biến gia tốc MPU6050 cùng với vi xử lý ESP32 nhằm ghi nhận hơi thở và nhịp tim của bệnh nhân OSA thông qua rung động, và dòng chảy của động mạch và tĩnh mạch ở cổ \cite{thuong_wear_paper}. Gần đây, Domingues và cộng sự (2024) xây dựng một mô hình mạng nơ-ron nhân tạo dựa trên dữ liệu từ máy đo (SpO$_2$), cấm biến gia tốc và ghi âm tiếng ngáy của hệ thống Biologix, nhằm dự đoán chính xác trạng thái ngủ. Kết quả cho thấy mô hình này có khả nâng cao độ chính xác trong chẩn đoán ngưng thở khi ngủ tại nhà, tiệm cận với tiêu chuẩn của đa ký giấc ngủ truyền thống \cite{domingues2024sleep}. Một hướng nghiên cứu khác là cảm biến đặt dưới nệm giường. Tác giả Andrei Boiko và cộng sự đánh giá hệ thống phát sử dụng cảm biến gia tốc đặt dưới đệm giường để ghi dao động do cử động ngực khi thở. Kết quả cho thấy thuật toán phát hiện ngưng thở đạt độ chính xác, độ đặc hiệu và độ nhạy lần lượt là 94.6\%, 95.3\% và 93.7\% \cite{Boiko2023}. 

Các mô hình học máy đã được ứng dụng rộng rãi trong bài toán phát hiện 
và phân loại hội chứng ngưng thở khi ngủ (Obstructive Sleep Apnea – OSA), 
đặc biệt là trong các hệ thống giám sát sử dụng cảm biến đeo. 
Đây là hướng tiếp cận liên ngành giữa y học giấc ngủ và trí tuệ nhân tạo ứng dụng, 
cho phép khai thác hiệu quả tín hiệu sinh lý (như ECG, PPG, accelerometer) 
nhằm phát hiện các sự kiện hô hấp bất thường và phân loại mức độ nghiêm trọng của 
OSA một cách tự động, nhanh chóng và chính xác \cite{osa_sanchez2025}. 
Trong số các thuật toán học máy truyền thống, Random Forest (RF) đã được chứng minh 
là một trong những phương pháp hiệu quả nhất nhờ khả năng kháng quá khớp và độ chính xác cao, 
với độ chính xác trên 93\% trong nhiều nghiên cứu \cite{genuer2020random,wang2023ml_wearable}. 
SVM, KNN và LDA cũng được sử dụng phổ biến nhờ khả năng phân loại mạnh mẽ và khả năng thích ứng 
với nhiều loại dữ liệu sinh lý \cite{cortes1995svm, cunningham2007knn, tharwat2017lda}. 
Bên cạnh đó, các thuật toán tiên tiến như XGBoost đã được triển khai để tăng tốc huấn luyện và 
cải thiện hiệu suất trong các hệ thống học máy gọn nhẹ (TinyML) 
phục vụ chẩn đoán lâm sàng \cite{chen2016xgboost}.

Bên cạnh các thuật toán học máy truyền thống, 
các mô hình học sâu (deep learning) như mạng nơ-ron nhân tạo (ANN), 
mạng nơ-ron tích chập (CNN), và mạng nơ-ron sâu (DNN) đã cho thấy hiệu quả vượt trội 
trong việc xử lý tín hiệu sinh lý phức tạp và nhận diện sự kiện hô hấp liên quan đến OSA. 
Nhiều nghiên cứu đã ứng dụng các kiến trúc CNN một chiều (1D-CNN), mạng kết hợp CNN–RNN,
và mạng tích chập đa tầng để phân loại tư thế ngủ, phát hiện nhịp thở bất thường và ước lượng chỉ 
số AHI với độ chính xác có thể đạt trên 90\% 
\cite{Vu2025SleepPosition,HOANG2025116309,Sleep_Posture_Detection}. 
Các mô hình này tận dụng khả năng tự động trích chọn đặc trưng từ dữ liệu cảm biến thô, 
hỗ trợ phát hiện OSA theo thời gian thực và tối ưu hóa hiệu năng. Những kết quả này khẳng định tiềm năng lớn của học sâu trong việc 
xây dựng các hệ thống giám sát giấc ngủ thế hệ mới, đặc biệt là trên các nền tảng nhúng và t
hiết bị đeo thông minh.

Với mục tiêu triển khai hệ thống trên thiết bị đeo có tài nguyên tính toán hạn chế, 
việc áp dụng các thuật toán học máy nhẹ (TinyML) đóng vai trò then chốt. 
Khác với các mô hình học sâu truyền thống yêu cầu phần cứng mạnh và 
tiêu tốn năng lượng, TinyML cho phép thực thi mô hình trực tiếp trên vi điều khiển 
có dung lượng bộ nhớ và tốc độ xử lý thấp, đồng thời đảm bảo độ trễ tối thiểu và khả năng 
hoạt động ngoại tuyến. Đặc điểm này đặc biệt phù hợp cho các ứng dụng y sinh tại nhà, 
nơi thiết bị cần hoạt động liên tục, chi phí thấp và không phụ thuộc vào kết nối mạng.

Tiny machine learning tập trung vào việc giảm thiểu số lượng tham số mô hình và độ phức tạp tính toán, 
nhờ đó trở thành một hướng tiếp cận đầy hứa hẹn trong các ứng dụng chăm 
sóc sức khỏe thông minh \cite{ray2021tinyml,diab2022embedded}. 
Tuy nhiên, vẫn tồn tại sự đánh đổi giữa việc đơn giản hóa mô hình và 
duy trì độ chính xác trong phân loại. Bài toán đặt ra là làm sao tối 
ưu hóa đồng thời kích thước mô hình, tốc độ xử lý và hiệu suất trong việc phân loại tình trạng OSA, nhận diện tư thế, 
đảm bảo hệ thống vừa đủ nhẹ để chạy trên phần cứng nhúng, vừa đủ chính xác để có giá trị trong giám sát y tế.




Mặc dù các nghiên cứu trước đây đã chứng minh hiệu quả của học máy trong phân loại tư thế ngủ và phát hiện OSA, 
phần lớn các hệ thống vẫn phụ thuộc vào dữ liệu đa kênh phức tạp, mô hình tính toán nặng, 
hoặc cần xử lý tập trung trên máy chủ. Điều này gây hạn chế khi triển khai thực tế 
tại nhà hoặc trên thiết bị đeo. Hơn nữa, vẫn còn thiếu các giải pháp tích hợp đầy đủ từ thu thập, 
xử lý, đến phân loại tín hiệu ngay trên vi điều khiển 
với độ trễ thấp và khả năng hoạt động độc lập không cần kết nối mạng. 
Luận văn này đề xuất một hướng tiếp cận mới, kết hợp cảm biến MEMS chi phí thấp với thuật toán TinyML tối ưu hóa trên thiết bị nhúng, nhằm xây dựng một hệ thống theo dõi tư thế ngủ cá nhân hóa, có tiềm năng hỗ trợ sàng lọc pOSA theo thời gian thực.
Thiết bị được thiết kế theo hướng đeo được (wearable), 
cho phép ghi nhận và phân loại chính xác các tư thế 
ngủ phổ biến như nằm ngửa, nằm sấp, nằm nghiêng trái và phải. 
Hệ thống tích hợp khả năng thu thập – xử lý – phân loại tín 
hiệu ngay trên vi điều khiển, hướng tới độ chính xác cao, 
độ trễ thấp và khả năng triển khai tại nhà với chi phí hợp lý. 
Tuy chưa thực hiện chức năng sàng lọc hội chứng ngưng thở khi ngủ (Obstructive Sleep Apnea – OSA), 
hệ thống được xây dựng như một nền tảng kỹ thuật tiềm năng, phục vụ cho các nghiên cứu ứng dụng trong tương lai, 
đặc biệt là hỗ trợ đánh giá nguy cơ pOSA dựa trên tư thế ngủ.
Luận văn trình bày tổng quan về hội chứng ngưng thở khi ngủ (Obstructive Sleep Apnea – OSA), 
nhấn mạnh tầm quan trọng của tư thế ngủ trong việc đánh giá nguy cơ mắc OSA theo tư thế (positional OSA – pOSA). 
Bên cạnh đó, các xu hướng công nghệ hiện đại ứng dụng trí tuệ nhân tạo (AI), 
cảm biến đeo được (wearable sensors) và học máy gọn nhẹ (TinyML) 
trong giám sát giấc ngủ cũng được hệ thống hóa nhằm làm 
cơ sở cho thiết kế hệ thống.

Trên cơ sở đó, đề tài tập trung xây dựng một hệ thống phần mềm ứng dụng cảm biến gia tốc 3 trục, 
sử dụng phần cứng có sẵn, để thu thập – xử lý và phân loại tư thế ngủ theo thời gian thực. 
Thiết bị kết nối với ứng dụng di động qua Bluetooth, giúp đồng bộ dữ liệu, 
hỗ trợ huấn luyện và triển khai mô hình học máy ngay trên thiết bị 
vi điều khiển. Hệ thống hướng tới khả năng ứng dụng tại nhà, 
hỗ trợ theo dõi tư thế ngủ – một yếu tố quan trọng trong đánh giá nguy cơ pOSA. Mục tiêu cụ thể của khóa luận gồm: 
01) nâng cao độ chính xác trong phân loại tư thế ngủ; 
02) tối ưu quy trình xử lý và phân tích dữ liệu; 
03) hỗ trợ thu thập, lưu trữ và xử lý dữ liệu theo thời gian thực; 
và 04) triển khai mô hình TinyML trên thiết bị biên.
Luận văn được thực hiện thông qua các phương pháp chính: 01) khảo sát và tổng hợp tài liệu liên quan đến OSA, cảm biến và học máy; 
02) xây dựng phần mềm thu thập – xử lý dữ liệu và thiết lập quy trình phân loại tư thế ngủ; 
và 03) thực nghiệm thu thập dữ liệu từ người dùng, huấn luyện và đánh giá hiệu năng mô hình học máy trên thiết bị nhúng.


Cấu trúc luận văn được trình bày trong ba chương chính như sau:

\noindent\textbf{Chương 1:} Tổng quan về hội chứng ngưng thở khi ngủ và các giải pháp công nghệ trong giám sát tư thế ngủ.

\noindent\textbf{Chương 2:} Xây dựng hệ thống thu thập dữ liệu, huấn luyện mô hình và chuẩn bị triển khai trên thiết bị biên.

\noindent\textbf{Chương 3:} Thử nghiệm mô hình phân loại tư thế ngủ và đánh giá triển khai trên nền tảng vi điều khiển.
